10.0.1.39 - - [18/Jul/2025:00:08:00 +0000] "POST /s/login_check HTTP/1.1" 302 587 "https://mautic.dasmedium.co/s/login" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36 Edg/138.0.0.0"
10.0.1.39 - - [18/Jul/2025:00:08:01 +0000] "GET /s/login HTTP/1.1" 200 13539 "https://mautic.dasmedium.co/s/login" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36 Edg/138.0.0.0"



ENV CONTENT

env | sort
APACHE_CONFDIR=/etc/apache2
APACHE_DOCUMENT_ROOT=/var/www/html/docroot
APACHE_ENVVARS=/etc/apache2/envvars
DOCKER_MAUTIC_LOAD_TEST_DATA=false
DOCKER_MAUTIC_ROLE=mautic_web
DOCKER_MAUTIC_RUN_MIGRATIONS=true
DOCKER_MAUTIC_WORKERS_CONSUME_EMAIL=2
DOCKER_MAUTIC_WORKERS_CONSUME_FAILED=2
DOCKER_MAUTIC_WORKERS_CONSUME_HIT=2
GPG_KEYS=528995BFEDFBA7191D46839EF9BA0ADA31CBD89E 39B641343D8C104B2B146DC3F9C39DC0B9698544 F1F692238FBC1666E5A5CCD4199F9DFEF6FFBAFD
HOME=/root
HOSTNAME=fa0dbf920009
MAUTIC_DB_DATABASE=mautic_db
MAUTIC_DB_HOST=mautic_db
MAUTIC_DB_PASSWORD=XNmYRAQETaavw6jfq47LE
MAUTIC_DB_PORT=3306
MAUTIC_DB_USER=mautic_db_user
MAUTIC_MESSENGER_DSN_EMAIL=doctrine://default
MAUTIC_MESSENGER_DSN_HIT=doctrine://default
MAUTIC_PORT=80
MAUTIC_TRUSTED_HEADERS=x-forwarded-for,x-forwarded-host,x-forwarded-proto
MAUTIC_TRUSTED_PROXIES=["0.0.0.0"]
MAUTIC_URL=https://mautic.dasmedium.co
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
PHPIZE_DEPS=autoconf            dpkg-dev                file            g++             gcc             libc-dev                make     pkg-config               re2c
PHP_ASC_URL=https://www.php.net/distributions/php-8.1.31.tar.xz.asc
PHP_CFLAGS=-fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64
PHP_CPPFLAGS=-fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64
PHP_INI_DIR=/usr/local/etc/php
PHP_INI_VALUE_DATE_TIMEZONE=UTC
PHP_INI_VALUE_MAX_EXECUTION_TIME=300
PHP_INI_VALUE_MEMORY_LIMIT=512M
PHP_INI_VALUE_POST_MAX_FILESIZE=512M
PHP_INI_VALUE_UPLOAD_MAX_FILESIZE=512M
PHP_LDFLAGS=-Wl,-O1 -pie
PHP_SHA256=c4f244d46ba51c72f7d13d4f66ce6a9e9a8d6b669c51be35e01765ba58e7afca
PHP_URL=https://www.php.net/distributions/php-8.1.31.tar.xz
PHP_VERSION=8.1.31
PWD=/var/www/html/docroot
SHLVL=1
TERM=xterm
TRUSTED_PROXIES=0.0.0.0/0
_=/usr/bin/env








4. Confirm Forwarded Headers from Traefik


curl -k -I https://mautic.dasmedium.co/s/login
HTTP/2 200 
cache-control: max-age=0, must-revalidate, private
content-type: text/html; charset=UTF-8
date: Sat, 19 Jul 2025 13:59:34 GMT
expires: Sat, 19 Jul 2025 13:59:34 GMT
server: Apache/2.4.62 (Debian)
set-cookie: 82fccce4af64e452b3a6af5a8267be70=600c240c37b30c60b41a671f10d381d3; path=/; secure; httponly; samesite=lax
x-powered-by: PHP/8.1.31


curl -k -v -H "Origin: https://mautic.dasmedium.co" \
     --data "username=dasmedium.co@gmail.com&password=JTi7hj0KhQHV1TUbJqb8@&_csrf_token=XYZ" \
     https://mautic.dasmedium.co/s/login_check
*   Trying 104.237.150.126:443...
* Connected to mautic.dasmedium.co (104.237.150.126) port 443 (#0)
* ALPN: offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
* TLSv1.3 (IN), TLS handshake, Server hello (2):
* TLSv1.3 (IN), TLS handshake, Encrypted Extensions (8):
* TLSv1.3 (IN), TLS handshake, Certificate (11):
* TLSv1.3 (IN), TLS handshake, CERT verify (15):
* TLSv1.3 (IN), TLS handshake, Finished (20):
* TLSv1.3 (OUT), TLS change cipher, Change cipher spec (1):
* TLSv1.3 (OUT), TLS handshake, Finished (20):
* SSL connection using TLSv1.3 / TLS_AES_128_GCM_SHA256
* ALPN: server accepted h2
* Server certificate:
*  subject: CN=mautic.dasmedium.co
*  start date: Jul 11 22:23:57 2025 GMT
*  expire date: Oct  9 22:23:56 2025 GMT
*  issuer: C=US; O=Let's Encrypt; CN=R10
*  SSL certificate verify result: unable to get local issuer certificate (20), continuing anyway.
* using HTTP/2
* h2h3 [:method: POST]
* h2h3 [:path: /s/login_check]
* h2h3 [:scheme: https]
* h2h3 [:authority: mautic.dasmedium.co]
* h2h3 [user-agent: curl/7.88.1]
* h2h3 [accept: */*]
* h2h3 [origin: https://mautic.dasmedium.co]
* h2h3 [content-length: 78]
* h2h3 [content-type: application/x-www-form-urlencoded]
* Using Stream ID: 1 (easy handle 0x55dce10ff780)
> POST /s/login_check HTTP/2
> Host: mautic.dasmedium.co
> user-agent: curl/7.88.1
> accept: */*
> origin: https://mautic.dasmedium.co
> content-length: 78
> content-type: application/x-www-form-urlencoded
> 
* TLSv1.3 (IN), TLS handshake, Newsession Ticket (4):
* We are completely uploaded and fine
< HTTP/2 302 
< cache-control: max-age=0, must-revalidate, private
< content-type: text/html; charset=utf-8
< date: Sat, 19 Jul 2025 14:00:50 GMT
< expires: Sat, 19 Jul 2025 14:00:50 GMT
< location: /s/login
< server: Apache/2.4.62 (Debian)
< set-cookie: 82fccce4af64e452b3a6af5a8267be70=9ced5fac9e6939a3325bc8c23dc2d2f5; path=/; secure; httponly; samesite=lax
< x-powered-by: PHP/8.1.31
< 
<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="refresh" content="0;url='/s/login'" />

        <title>Redirecting to /s/login</title>
    </head>
    <body>
        Redirecting to <a href="/s/login">/s/login</a>.
    </body>
* Connection #0 to host mautic.dasmedium.co left intact
</html>


5. Validate Mautic Base URL

I have set multiple environment varibles addressing the Mautic URL. The Env | Sort should show what set.


6 Session / Cookie Integrity Test

Value: 9296fcaf68f760a10d3d45a8be9e574a
Created:"Sat, 19 Jul 2025 13:24:25 GMT"
Domain:"mautic.dasmedium.co"
Expires / Max-Age:"Session"
HostOnly:true
HttpOnly:true
Last Accessed:"Sat, 19 Jul 2025 14:03:27 GMT"
Path:"/"
SameSite:"Lax"
Secure:true
Size:64

CLI confirmation:


docker exec -it mautic grep session.save_path /usr/local/etc/php/php.ini
docker exec -it mautic ls -al /path/to/php/sessions

 Will Need Help Locating the session path in the container.

 7. CSRF Token Validation

 Does not seem to be present.

 8. Reset / Confirm User Credentials (just in case)

 mautic:user:resetpassword = this is not a real command in Mautic 5.x


$2y$13$tnEukTjvI0Yw1yHjhwL4r.hYI3pptXMoximU3u4pmqD8ciLJxbgu2

UPDATE users SET password='$2y$13$tnEukTjvI0Yw1yHjhwL4r.hYI3pptXMoximU3u4pmqD8ciLJxbgu2' WHERE email='dasmedium.co@gmail.com';